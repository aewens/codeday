// Generated by CoffeeScript 1.7.1
(function() {
  define(["block"], function(Block) {
    var Map;
    Map = (function() {
      function Map(w, h, size) {
        var i, _i, _ref;
        this.w = w;
        this.h = h;
        this.size = size;
        this.world = [];
        this.blocks = [];
        this.objects = [];
        this.length = this.w * this.h;
        for (i = _i = 0, _ref = this.length; 0 <= _ref ? _i < _ref : _i > _ref; i = 0 <= _ref ? ++_i : --_i) {
          this.blocks.push(null);
        }
        this;
      }

      Map.prototype.use = function(object) {
        return this.objects.push(object);
      };

      Map.prototype.fill = function(x, y, type) {
        var block;
        if (type === "void") {
          return null;
        }
        block = new Block(x * this.size, y * this.size, this.size, "#000");
        block.real.give("type", type);
        return block;
      };

      Map.prototype.locate = function(key, type) {
        return this.blocks[key] = this.fill(key % this.width, Math.floor(key / this.w), type);
      };

      Map.prototype.select = function(x, y, type) {
        return this.blocks[x + y * this.w] = this.fill(x, y, type);
      };

      Map.prototype.row = function(r, type) {
        var x, _i, _ref, _results;
        _results = [];
        for (x = _i = 0, _ref = this.w; 0 <= _ref ? _i < _ref : _i > _ref; x = 0 <= _ref ? ++_i : --_i) {
          _results.push(this.blocks[x + r * this.w] = this.fill(x, r, type));
        }
        return _results;
      };

      Map.prototype.col = function(c, type) {
        var y, _i, _ref, _results;
        _results = [];
        for (y = _i = 0, _ref = this.h; 0 <= _ref ? _i < _ref : _i > _ref; y = 0 <= _ref ? ++_i : --_i) {
          _results.push(this.blocks[c + y * this.w] = this.fill(c, y, type));
        }
        return _results;
      };

      Map.prototype.fromR = function(x, y, to, type) {
        var i, _i, _results;
        _results = [];
        for (i = _i = 0; 0 <= to ? _i < to : _i > to; i = 0 <= to ? ++_i : --_i) {
          _results.push(this.blocks[(x + i) + y * this.w] = this.fill(x + i, y, type));
        }
        return _results;
      };

      Map.prototype.fromD = function(x, y, to, type) {
        var i, _i, _results;
        _results = [];
        for (i = _i = 0; 0 <= to ? _i < to : _i > to; i = 0 <= to ? ++_i : --_i) {
          _results.push(this.blocks[x + (y + i) * this.w] = this.fill(x, y + i, type));
        }
        return _results;
      };

      Map.prototype.getAll = function() {
        return this.blocks.filter(function(x) {
          return x !== null;
        });
      };

      Map.prototype.update = function() {
        return this.world = this.getAll();
      };

      Map.prototype.render = function() {
        var blocks, i, _i, _ref, _results;
        blocks = this.getAll();
        _results = [];
        for (i = _i = 0, _ref = blocks.length; 0 <= _ref ? _i < _ref : _i > _ref; i = 0 <= _ref ? ++_i : --_i) {
          _results.push(blocks[i].real.render());
        }
        return _results;
      };

      return Map;

    })();
    return Map;
  });

}).call(this);
